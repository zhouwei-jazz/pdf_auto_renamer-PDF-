# PDF文件标题提取器

这是一个用于从PDF文件中提取标题并重命名文件的图形界面工具。程序能够智能识别PDF文档中的标题文本，支持中英文混合标题的提取，并提供批量处理功能。

## 功能特点

- 支持单个PDF文件或批量处理
- 智能提取PDF第一页中的标题文本
- 优化的中英文混合标题识别算法
- 支持文件/文件夹拖放导入（Windows平台）
- 提供多个标题候选选项
- 保留原文件名作为参考
- 支持自定义标题
- 实时预览重命名结果
- 跨平台支持（Windows/Mac）

## 最新改进

- 增强了中英文混合标题的识别能力
- 添加了文件和文件夹拖放功能（Windows平台）
- 提供多个标题候选选项，更精确地提取标题
- 智能处理字体大小差异，提高标题识别准确率
- 优化了用户界面和用户体验

## 安装说明

1. 确保已安装Python 3.6或更高版本
2. 安装依赖包：
   ```
   pip install -r requirements.txt
   ```
3. 在Windows平台上，还需要安装windnd以支持拖放功能：
   ```
   pip install windnd
   ```

## 使用方法

1. 运行程序：
   ```
   python main.py
   ```
2. 导入PDF文件（三种方法）：
   - 点击"选择文件"按钮
   - 点击"选择文件夹"按钮
   - 直接拖放文件/文件夹到程序窗口（Windows平台）
3. 从列表中选择要处理的文件
4. 在预览面板中选择合适的标题或输入自定义标题
5. 确认预览的新文件名无误后，点击"确认重命名"按钮
6. 可以使用"批量预览"或"批量处理"功能一次处理多个文件

## 标题提取算法

程序使用以下策略提取PDF标题：

1. 分析PDF第一页的文本元素，提取字体大小、位置等属性
2. 过滤掉页眉区域和纯数字文本
3. 提取最大字体大小的文本作为主要候选标题
4. 智能分析文本的行结构，提供基于行的候选标题
5. 处理中英文混合情况，智能添加/移除空格

## 打包发布

可以使用PyInstaller将程序打包为独立可执行文件：
```
python build_config.py
```

打包后的程序将在`dist`目录中生成。

## 注意事项

- 程序会保留原文件名在新文件名的末尾
- 批量处理默认使用第一个标题候选
- 如果自动提取的标题不理想，可以使用自定义标题功能

## 贡献

欢迎提交问题和改进建议！

## 许可证

[MIT License](LICENSE) 